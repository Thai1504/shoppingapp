<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Hotel Procurement Management System</title>
    <link rel="stylesheet" href="css/styles.css">
    <meta name="description" content="Ứng dụng quản lý mua sắm cho 4 khách sạn">
    <meta name="theme-color" content="#2c5aa0">
</head>
<body>
    <!-- Loading indicator -->
    <div id="loadingIndicator" class="loading">
        <div class="loading-spinner"></div>
        <p>Đang tải...</p>
    </div>

    <div class="container">

        <!-- Professional Navigation -->
        <div class="sticky-nav" id="stickyNav">
            <div class="nav-container">
                <!-- Date Selection -->
                <div class="nav-row">
                    <input type="date" id="selectedDate" class="nav-input" required>
                    <button id="todayBtn" class="btn btn-today">Today</button>
                    <button id="printBtn" class="btn btn-print" title="Print shopping list" style="display: none;">Print</button>
                    <button id="exportBtn" class="btn btn-export" title="Export HTML file" style="display: none;">Export</button>
                    <button id="cleanupBtn" class="btn btn-icon" title="Data cleanup">⚙</button>
                </div>

                <!-- Hotel Selection -->
                <div class="nav-row">
                    <select id="hotelSelect" class="nav-select">
                        <option value="">-- Select Property --</option>
                        <option value="36LS">Hotel 36LS</option>
                        <option value="16TX">Hotel 16TX</option>
                        <option value="55HT">Hotel 55HT</option>
                        <option value="49HG">Hotel 49HG</option>
                    </select>
                </div>

                <!-- Section Tabs -->
                <div class="nav-row">
                    <div class="section-tabs">
                        <button class="section-tab" data-section="thit">
                            Meat & Poultry
                        </button>
                        <button class="section-tab" data-section="rau">
                            Vegetables & Produce
                        </button>
                        <button class="section-tab" data-section="dokho">
                            Dry Goods & Pantry
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search and Filter Section -->
        <div class="search-section" id="searchSection">
            <input type="text" id="searchInput" class="search-input" placeholder="Search products...">
            <select id="statusFilter" class="filter-select">
                <option value="all">All Items</option>
                <option value="pending">Pending</option>
                <option value="done">Completed</option>
            </select>
        </div>

        <!-- Items List -->
        <div class="items-list" id="itemsList">

            <!-- Items Table -->
            <div class="table-container">
                <table class="items-table" id="itemsTable">
                    <thead>
                        <tr>
                            <th class="col-checkbox">Status</th>
                            <th class="col-name-unit">Product</th>
                            <th class="col-price edit-mode-only" style="display: none;">Purchase (k₫)</th>
                            <th class="col-price edit-mode-only" style="display: none;">Sale (k₫)</th>
                            <th class="col-total">Total Purchase (k₫)</th>
                            <th class="col-total">Total Sale (k₫)</th>
                            <th class="col-actions">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="itemsTableBody">
                        <!-- Items will be populated here -->
                    </tbody>
                    <tfoot id="itemsTableFooter" style="display: none;">
                        <tr class="totals-row">
                            <td class="totals-label">
                                <strong>TOTAL</strong>
                            </td>
                            <td class="totals-summary">
                                <strong id="itemCount">0 items</strong>
                            </td>
                            <td class="totals-price edit-mode-only" style="display: none;">
                                <!-- Price columns space -->
                            </td>
                            <td class="totals-price edit-mode-only" style="display: none;">
                                <!-- Price columns space -->
                            </td>
                            <td class="totals-buy">
                                <strong id="totalBuyAmount">0₫</strong>
                            </td>
                            <td class="totals-sell">
                                <strong id="totalSellAmount">0₫</strong>
                            </td>
                            <td class="totals-actions">
                                <!-- Actions space -->
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>

            <!-- Empty State -->
            <div class="empty-state" id="emptyState">
                <div class="empty-icon">□</div>
                <h4>No Products Yet</h4>
                <p>Add your first product to get started</p>
            </div>
        </div>
    </div>


    <!-- Add Item Button -->
    <button class="add-item-btn" id="addItemBtn" style="display: none;" title="Add Product">
        + Add Product
    </button>

    <!-- Add Item Modal -->
    <div class="modal add-item-modal" id="addItemModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Product</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            
            <form id="itemForm" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>Select from existing products:</label>
                        <select id="itemPool" class="form-select">
                            <option value="">-- Select from list --</option>
                        </select>
                    </div>
                </div>

                <div class="form-row form-row-compact">
                    <div class="form-group form-group-name">
                        <label>Product Name</label>
                        <input type="text" id="itemName" class="form-input" placeholder="Enter product name" required>
                    </div>
                    <div class="form-group form-group-quantity">
                        <label>Quantity</label>
                        <input type="number" id="quantity" class="form-input" value="1" step="0.1" min="0" placeholder="Quantity" required>
                    </div>
                    <div class="form-group form-group-unit">
                        <label>Unit</label>
                        <select id="unit" class="form-select" required>
                            <option value="kg">kg</option>
                            <option value="gram">gram</option>
                            <option value="liter">liter</option>
                            <option value="bottle">bottle</option>
                            <option value="pack">pack</option>
                            <option value="piece">piece</option>
                            <option value="case">case</option>
                            <option value="box">box</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Purchase Price (k₫)</label>
                        <input type="number" id="buyPrice" class="form-input" placeholder="0.00" min="0">
                    </div>
                    <div class="form-group">
                        <label>Sale Price (k₫)</label>
                        <input type="number" id="sellPrice" class="form-input" placeholder="0.00" min="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="saveToPool" class="form-checkbox">
                            Save to product catalog for future use
                        </label>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">
                        Add Product
                    </button>
                    <button type="button" id="clearFormBtn" class="btn btn-secondary">
                        Clear Form
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Item Modal -->
    <div class="modal edit-item-modal" id="editItemModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Product</h3>
                <button class="modal-close" id="editModalClose">&times;</button>
            </div>
            
            <form id="editItemForm" class="modal-form">
                <input type="hidden" id="editItemId">
                
                <div class="form-row form-row-compact">
                    <div class="form-group form-group-name">
                        <label>Product Name</label>
                        <input type="text" id="editItemName" class="form-input" placeholder="Enter product name" required>
                    </div>
                    <div class="form-group form-group-quantity">
                        <label>Quantity</label>
                        <input type="number" id="editQuantity" class="form-input" step="0.1" min="0" placeholder="Quantity" required>
                    </div>
                    <div class="form-group form-group-unit">
                        <label>Unit</label>
                        <select id="editUnit" class="form-select" required>
                            <option value="kg">kg</option>
                            <option value="gram">gram</option>
                            <option value="liter">liter</option>
                            <option value="bottle">bottle</option>
                            <option value="pack">pack</option>
                            <option value="piece">piece</option>
                            <option value="case">case</option>
                            <option value="box">box</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Purchase Price (k₫)</label>
                        <input type="number" id="editBuyPrice" class="form-input" placeholder="0.00" min="0">
                    </div>
                    <div class="form-group">
                        <label>Sale Price (k₫)</label>
                        <input type="number" id="editSellPrice" class="form-input" placeholder="0.00" min="0">
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">
                        Save Changes
                    </button>
                    <button type="button" id="editCancelBtn" class="btn btn-secondary">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Cleanup Modal -->
    <div class="modal cleanup-modal" id="cleanupModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Data Cleanup</h3>
                <button class="modal-close" id="cleanupModalClose">&times;</button>
            </div>
            
            <form id="cleanupForm" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>From Date:</label>
                        <input type="date" id="cleanupFromDate" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label>To Date:</label>
                        <input type="date" id="cleanupToDate" class="form-input" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="quick-select">
                        <button type="button" class="btn btn-secondary btn-sm" onclick="app.setCleanupRange(30)">1 month ago</button>
                        <button type="button" class="btn btn-secondary btn-sm" onclick="app.setCleanupRange(90)">3 months ago</button>
                        <button type="button" class="btn btn-secondary btn-sm" onclick="app.setCleanupRange(180)">6 months ago</button>
                    </div>
                </div>

                <div class="cleanup-preview">
                    <p id="cleanupPreview">Select date range to preview data that will be deleted</p>
                </div>

                <div class="modal-actions">
                    <button type="button" id="previewCleanupBtn" class="btn btn-secondary">
                        Preview
                    </button>
                    <button type="submit" id="executeCleanupBtn" class="btn btn-danger" disabled>
                        Delete Data
                    </button>
                    <button type="button" id="cleanupCancelBtn" class="btn btn-secondary">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h3 id="confirmTitle">Confirm Action</h3>
            <p id="confirmMessage">Are you sure you want to perform this action?</p>
            <div class="modal-actions">
                <button id="confirmYes" class="btn btn-primary">Yes</button>
                <button id="confirmNo" class="btn btn-secondary">No</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Hidden file input for import -->
    <input type="file" id="fileInput" accept=".json" style="display: none;">

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/data.js"></script>
    <script src="js/app.js"></script>
</body>
</html>